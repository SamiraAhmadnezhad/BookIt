# ูุงู workflow ฺฉู ุฏุฑ ุชุจ Actions ููุงุด ุฏุงุฏู ูโุดูุฏ
name: Deploy Flutter Web to GitHub Pages

# ุชุฑฺฏุฑูุง: ฺู ุฒูุงู ุงู workflow ุงุฌุฑุง ุดูุฏ
on:
  # 1. ูุฑ ุจุงุฑ ฺฉู ฺฉุฏ ุจู ุดุงุฎู main ูพูุด ูโุดูุฏ
  push:
    branches:
      - main
  
  # 2. ุจู ุดูุง ุงุฌุงุฒู ูโุฏูุฏ ุงู workflow ุฑุง ุจู ุตูุฑุช ุฏุณุช ุงุฒ ุชุจ Actions ุงุฌุฑุง ฺฉูุฏ (ุจุฑุง ุฏุจุงฺฏ ฺฉุฑุฏู ุนุงู ุงุณุช)
  workflow_dispatch:

jobs:
  build_and_deploy:
    # ุงุณุชูุงุฏู ุงุฒ ุขุฎุฑู ูุณุฎู ุงูุจููุชู ุจุฑุง ุงุฌุฑุง ฺฉุงุฑ
    runs-on: ubuntu-latest

    # ูุฌูุฒูุง ูุงุฒู ุจุฑุง workflow ุฌูุช ูพูุด ฺฉุฑุฏู ุจู ุดุงุฎู gh-pages
    permissions:
      contents: read
      pages: write
      id-token: write

    steps:
      # ูุฑุญูู 1: ฺฉุฏูุง ุฑูพุงุฒุชูุฑ ุฑุง ุฑู ูุงุดู ูุฌุงุฒ ูโุขูุฑุฏ
      - name: Checkout ๐๏ธ
        uses: actions/checkout@v3

      # ูุฑุญูู 2: ูุตุจ ู ุฑุงูโุงูุฏุงุฒ ููุงุชุฑ (ุจุง ูุงุจูุช ฺฉุด ุจุฑุง ุณุฑุนุช ุจุดุชุฑ ุฏุฑ ุงุฌุฑุงูุง ุจุนุฏ)
      - name: Setup Flutter SDK ๐ฆ
        uses: subosito/flutter-action@v2
        with:
          channel: 'stable'
          cache: true

      # ูุฑุญูู 3: ูุตุจ ูพฺฉุฌโูุง ูพุฑูฺู
      - name: Install Dependencies ๐จโ๐ป
        run: flutter pub get

      # ูุฑุญูู 4: ุณุงุฎุช ูุณุฎู ูุจ ุจููู ุดุฏู (ุจุณุงุฑ ููู)
      # --base-href ุจุงุนุซ ูโุดูุฏ ุณุงุช ุดูุง ุฏุฑ ุขุฏุฑุณ ุฒุฑูพูุดู ฺฏุชโูุงุจ ุจู ุฏุฑุณุช ฺฉุงุฑ ฺฉูุฏ
      - name: Build Web ๐๏ธ
        run: flutter build web --release --base-href /${{ github.event.repository.name }}/

      # ูุฑุญูู 5: ุงูุชุดุงุฑ ูุงูโูุง ุณุงุฎุชู ุดุฏู ุฏุฑ ุดุงุฎู gh-pages
      - name: Deploy to GitHub Pages ๐
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          # ุชูฺฉู ุจุฑุง ุฏุงุฏู ุฏุณุชุฑุณ ุจู ุงฺฉุดู (ฺฉ ุงูุฏุงู ุงุญุชุงุท)
          token: ${{ secrets.GITHUB_TOKEN }}
          # ุดุงุฎูโุง ฺฉู ูุงูโูุง ููุง ุฏุฑ ุขู ูุฑุงุฑ ูโฺฏุฑุฏ
          branch: gh-pages
          # ูพูุดูโุง ฺฉู ูุญุชูุง ุขู ุจุงุฏ ููุชุดุฑ ุดูุฏ
          folder: build/web