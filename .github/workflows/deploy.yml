# Ù†Ø§Ù… workflow Ú©Ù‡ Ø¯Ø± ØªØ¨ Actions Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
name: Deploy Flutter Web to GitHub Pages

# ØªØ±ÛŒÚ¯Ø±Ù‡Ø§: Ú†Ù‡ Ø²Ù…Ø§Ù†ÛŒ Ø§ÛŒÙ† workflow Ø§Ø¬Ø±Ø§ Ø´ÙˆØ¯
on:
  # 1. Ù‡Ø± Ø¨Ø§Ø± Ú©Ù‡ Ú©Ø¯ÛŒ Ø¨Ù‡ Ø´Ø§Ø®Ù‡ main Ù¾ÙˆØ´ Ù…ÛŒâ€ŒØ´ÙˆØ¯
  push:
    branches:
      - main
  
  # 2. Ø¨Ù‡ Ø´Ù…Ø§ Ø§Ø¬Ø§Ø²Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ Ø§ÛŒÙ† workflow Ø±Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø¯Ø³ØªÛŒ Ø§Ø² ØªØ¨ Actions Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯ (Ø¨Ø±Ø§ÛŒ Ø¯ÛŒØ¨Ø§Ú¯ Ú©Ø±Ø¯Ù† Ø¹Ø§Ù„ÛŒ Ø§Ø³Øª)
  workflow_dispatch:

jobs:
  build_and_deploy:
    # Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø¢Ø®Ø±ÛŒÙ† Ù†Ø³Ø®Ù‡ Ø§ÙˆØ¨ÙˆÙ†ØªÙˆ Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ Ú©Ø§Ø±
    runs-on: ubuntu-latest

    # Ù…Ø¬ÙˆØ²Ù‡Ø§ÛŒ Ù„Ø§Ø²Ù… Ø¨Ø±Ø§ÛŒ workflow Ø¬Ù‡Øª Ù¾ÙˆØ´ Ú©Ø±Ø¯Ù† Ø¨Ù‡ Ø´Ø§Ø®Ù‡ gh-pages
    permissions:
      contents: read
      pages: write
      id-token: write

    steps:
      # Ù…Ø±Ø­Ù„Ù‡ 1: Ú©Ø¯Ù‡Ø§ÛŒ Ø±ÛŒÙ¾Ø§Ø²ÛŒØªÙˆØ±ÛŒ Ø±Ø§ Ø±ÙˆÛŒ Ù…Ø§Ø´ÛŒÙ† Ù…Ø¬Ø§Ø²ÛŒ Ù…ÛŒâ€ŒØ¢ÙˆØ±Ø¯
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v3

      # Ù…Ø±Ø­Ù„Ù‡ 2: Ù†ØµØ¨ Ùˆ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ ÙÙ„Ø§ØªØ± (Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØª Ú©Ø´ Ø¨Ø±Ø§ÛŒ Ø³Ø±Ø¹Øª Ø¨ÛŒØ´ØªØ± Ø¯Ø± Ø§Ø¬Ø±Ø§Ù‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ)
      - name: Setup Flutter SDK ğŸ¦
        uses: subosito/flutter-action@v2
        with:
          channel: 'stable'
          cache: true

      # Ù…Ø±Ø­Ù„Ù‡ 3: Ù†ØµØ¨ Ù¾Ú©ÛŒØ¬â€ŒÙ‡Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡
      - name: Install Dependencies ğŸ‘¨â€ğŸ’»
        run: flutter pub get

      # Ù…Ø±Ø­Ù„Ù‡ 4: Ø³Ø§Ø®Øª Ù†Ø³Ø®Ù‡ ÙˆØ¨ Ø¨Ù‡ÛŒÙ†Ù‡ Ø´Ø¯Ù‡ (Ø¨Ø³ÛŒØ§Ø± Ù…Ù‡Ù…)
      # --base-href Ø¨Ø§Ø¹Ø« Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ø³Ø§ÛŒØª Ø´Ù…Ø§ Ø¯Ø± Ø¢Ø¯Ø±Ø³ Ø²ÛŒØ±Ù¾ÙˆØ´Ù‡ Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨ Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ Ú©Ø§Ø± Ú©Ù†Ø¯
      - name: Build Web ğŸ—ï¸
        run: flutter build web --release --base-href /${{ github.event.repository.name }}/

      # Ù…Ø±Ø­Ù„Ù‡ 5: Ø§Ù†ØªØ´Ø§Ø± ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ Ø¯Ø± Ø´Ø§Ø®Ù‡ gh-pages
      - name: Deploy to GitHub Pages ğŸš€
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          # Ø§Ø² ØªÙˆÚ©Ù† Ø´Ø®ØµÛŒ Ù…Ø§ Ø¨Ù‡ Ø¬Ø§ÛŒ ØªÙˆÚ©Ù† Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†
          token: ${{ secrets.DEPLOY_TOKEN }}
          branch: gh-pages
          folder: build/web